<!doctype html>
<html class="no-js" lang="{{shortlang}}">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{#i18n}}page.title{{/i18n}}</title>
    <link rel="stylesheet" href="/css/fonts.css" />

    <link rel="stylesheet" href="/themes/wmch-interactive-maps-v3-theme/css/app.css" />
    <link rel="stylesheet" href="/css/mailmap.css" />
    <link rel="stylesheet" href="//tools-static.wmflabs.org/cdnjs/ajax/libs/codemirror/5.65.1/codemirror.css">
    <link rel="stylesheet" href="//tools-static.wmflabs.org/cdnjs/ajax/libs/font-awesome/6.0.0/css/brands.min.css">
  </head>
  <body>
    <div class="grid-container full">
      <div class="grid-x">
        <div class="cell margin-bottom-1 padding-top-1">
                              <div class="grid-container">
                                <div class="grid-x grid-padding-x small-padding-collapse">
                                    <div class="cell medium-6 large-4">
                                      <a href="#" class="text-hide">
                                        <img src="{{logo.src}}" alt="{{logo.alt}}" height="{{logo.height}}" {{#logo.bgcolor}} style="background-color: {{logo.bgcolor}};" {{/logo.bgcolor}}>
                                        Wikimedia CH <!-- Logo Text  -->
                                      </a>
                                    </div>
                                    <div class="cell medium-6 large-8">
                                      <ul class="menu dropdown align-right" data-dropdown-menu>
                                        <li>
                                          <a class="rounded primary dropdown button padding-right-2 padding-left-2" href="#">{{{langname}}}</a>
                                          <ul class="menu">
                                            {{#languages}}
                                            <li><a data-value="{{code}}" href="?l={{code}}">{{name}}</a></li>
                                            {{/languages}}
                                          </ul>
                                        </li>
                                      </ul>
                                    </div>
                                </div>
                              </div>
        </div>
        <div class="header-your-map cell margin-bottom-1 padding-top-2 padding-bottom-2">
                              <div class="grid-container">
                                <div class="grid-x">
                                  <div class="cell">
                                    <h1 class="h3">{{#i18n}}page.title{{/i18n}}</h1>
                                    <p>{{#i18n}}comment.label{{/i18n}}</p>
                                  </div>
                                </div>
                              </div>
        </div>
        <div class="cell">
                              <div class="grid-container">
                                <form class="grid-x" id="askmap" action="/your-map" method="get">
                                  <fieldset class="cell">
                                    <legend>{{#i18n}}asktype.legend{{/i18n}}</legend>
                                    <input type="radio" name="asktype" value="New" id="asknewmap" required><label for="asknewmap">{{#i18n}}asktype.asknewmap{{/i18n}}</label>
                                    <input type="radio" name="asktype" value="Change existing map" id="askchangemap"><label for="askchangemap">{{#i18n}}asktype.askchangemap{{/i18n}}</label>
                                    <input type="radio" name="asktype" value="Other request" id="askother"><label for="askother">{{#i18n}}asktype.askother{{/i18n}}</label>
                                  </fieldset>
                                  <fieldset class="cell">
                                    <legend></legend>
                                    <label>
                                      {{#i18n}}comment.label{{/i18n}}
                                      <textarea name="comment" rows="3" placeholder="{{#i18n}}comment.placeholder{{/i18n}}" aria-describedby="commentHelpText"></textarea>
                                    </label>
                                    <p class="help-text" id="commentHelpText">{{#i18n}}comment.help{{/i18n}}</p>
                                  </fieldset>
                                  <fieldset class="cell">
                                    <legend>{{#i18n}}ihavesparql.legend{{/i18n}}</legend>
                                    <input type="radio" name="ihavesparql" value="N" id="sparqlno" required><label for="sparqlno">{{#i18n}}ihavesparql.sparqlno{{/i18n}}</label>
                                    <input type="radio" name="ihavesparql" value="Y" id="sparqlyes"><label for="sparqlyes">{{#i18n}}ihavesparql.sparqlyes{{/i18n}}</label>
                                  </fieldset>
                                  <fieldset class="cell padding-bottom-2" id="sparql-container" style="display: none;">
                                    <legend></legend>
                                    <label>
                                      {{#i18n}}sparql.label{{/i18n}}
                                      <textarea name="sparql" rows="14" placeholder="{{#i18n}}sparql.label{{/i18n}}" aria-describedby="sparqlHelpText"></textarea>
                                    </label>
                                  </fieldset>
                                  <p class="cell help-text" id="sparqlHelpText">{{#i18n}}sparql.help{{/i18n}}</p>
                                  <input type="submit" class="button" value="{{#i18n}}submit{{/i18n}}">
                              </form>
                              </div>
        </div>
        <div class="cell ov-footer margin-top-2">
                              <div class="grid-container">
                                <div class="grid-x grid-padding-y">
                                    <div class="cell text-right medium-11 large-11">
                                      {{#author}}
                                        {{{author}}}
                                      {{/author}}
                                      <a title="wmch-interactive-maps@github" class="clear large button secondary margin-bottom-0 padding-0" href="https://github.com/synapta/wmch-interactive-maps" target="_blank"><span aria-hidden="true"><span class="show-for-sr">Fork me on GitHub</span><span class="fa-brands fa-github"></span></a>
                                    </div>          
                                </div>
                              </div>
        </div>
      </div>
    </div>
    
    <script src="//tools-static.wmflabs.org/cdnjs/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="//tools-static.wmflabs.org/cdnjs/ajax/libs/foundation/6.7.4/js/foundation.min.js"></script>
    <script src="//tools-static.wmflabs.org/cdnjs/ajax/libs/foundation/6.7.4/js/foundation.dropdown.min.js"></script>
    <script src="/themes/wmch-interactive-maps-v3-theme/js/app.js"></script>
    <script src="//tools-static.wmflabs.org/cdnjs/ajax/libs/codemirror/5.65.1/codemirror.js"></script>
    <script src="//tools-static.wmflabs.org/cdnjs/ajax/libs/codemirror/5.65.1/mode/sparql/sparql.js"></script>
    <script>
      var sparqlQueryExample = `# Example query: keep the name and the use identical to these ones
SELECT ?item ?itemLabel ?coord ?commons ?website ?img ?lang ?langcode
WHERE {
  ?item wdt:P31/wdt:P279* wd:Q6581615 .
  ?item wdt:P625 ?coord
        OPTIONAL { ?item wdt:P373 ?commons }
        OPTIONAL { ?item wdt:P856 ?website }
        OPTIONAL { ?item wdt:P18 ?img }
        OPTIONAL {
          ?art schema:about ?item ;
          schema:inLanguage ?langcode .
          BIND(IF(?langcode in ('en', 'it', 'fr', 'de'),?art,?langcode) AS ?lang)
        }
  SERVICE wikibase:label { bd:serviceParam wikibase:language "en,de,fr,it". }
}
ORDER BY ?item ASC(?langcode) ASC(?lang) DESC(?coord) ASC(?commons) DESC(?website) ASC(?img)`;

      function loadCodeEditor () {
        var textarea = document.getElementsByName("sparql")[0];
        var myCodeMirror = CodeMirror(function(elt) {
          textarea.parentNode.replaceChild(elt, textarea);
        }, {
          value: textarea.value,
          mode: "sparql", 
          dragDrop: false,
          lineNumbers: true,
          value: sparqlQueryExample
        });
      }

      function showOrHideCodeEditor () {
        if ($("#sparqlyes").is(":checked")) {
          $("fieldset#sparql-container").show();
          if (!$("body").hasClass('code-editor-loaded')) {
            loadCodeEditor();
          }
          $("body").addClass('code-editor-loaded');
        }
        else {
          $("fieldset#sparql-container").hide();
        }
      }

      $(document).ready(showOrHideCodeEditor)
      $('form input[type=radio]').on('click', showOrHideCodeEditor);
    </script>

  </body>
</html>
